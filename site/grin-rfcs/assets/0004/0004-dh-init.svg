<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="608" height="498" contentScriptType="application/ecmascript" contentStyleType="text/css" style="width:608px;height:498px" preserveAspectRatio="none" version="1.1" viewBox="0 0 608 498" zoomAndPan="magnify"><defs><filter id="f14n62ugonf14k" width="300%" height="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text x="161.75" y="23.006" fill="#000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="276">Wallet JSON-RPC API ECDH Initialization</text><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="29" x2="29" y1="117.6" y2="410.8"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="215.5" x2="215.5" y1="117.6" y2="410.8"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="402.5" x2="402.5" y1="117.6" y2="410.8"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="533.5" x2="533.5" y1="117.6" y2="410.8"/><text x="8" y="113.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36">Client</text><ellipse cx="29" cy="43.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)" rx="8" ry="8" style="stroke:#a80036;stroke-width:2"/><path fill="none" d="M29,51.7999 L29,78.7999 M16,59.7999 L42,59.7999 M29,78.7999 L16,93.7999 M29,78.7999 L42,93.7999" filter="url(#f14n62ugonf14k)" style="stroke:#a80036;stroke-width:2"/><text x="8" y="422.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36">Client</text><ellipse cx="29" cy="436.6" fill="#FEFECE" filter="url(#f14n62ugonf14k)" rx="8" ry="8" style="stroke:#a80036;stroke-width:2"/><path fill="none" d="M29,444.5999 L29,471.5999 M16,452.5999 L42,452.5999 M29,471.5999 L16,486.5999 M29,471.5999 L42,486.5999" filter="url(#f14n62ugonf14k)" style="stroke:#a80036;stroke-width:2"/><rect style="stroke:#a80036;stroke-width:1.5" width="111" height="30.8" x="158.5" y="81.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="165.5" y="101.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97">JSON-RPC API</text><rect style="stroke:#a80036;stroke-width:1.5" width="111" height="30.8" x="158.5" y="409.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="165.5" y="429.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97">JSON-RPC API</text><rect style="stroke:#a80036;stroke-width:1.5" width="121" height="30.8" x="340.5" y="81.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="347.5" y="101.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107">Internal Rust API</text><rect style="stroke:#a80036;stroke-width:1.5" width="121" height="30.8" x="340.5" y="409.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="347.5" y="429.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107">Internal Rust API</text><rect style="stroke:#a80036;stroke-width:1.5" width="112" height="30.8" x="475.5" y="81.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="482.5" y="101.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98">Wallet Backend</text><rect style="stroke:#a80036;stroke-width:1.5" width="112" height="30.8" x="475.5" y="409.8" fill="#FEFECE" filter="url(#f14n62ugonf14k)"/><text x="482.5" y="429.806" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98">Wallet Backend</text><rect style="stroke:#eee;stroke-width:1" width="593.5" height="3" x="3" y="148.4" fill="#EEE" filter="url(#f14n62ugonf14k)"/><line style="stroke:#000;stroke-width:1" x1="3" x2="596.5" y1="148.4" y2="148.4"/><line style="stroke:#000;stroke-width:1" x1="3" x2="596.5" y1="151.4" y2="151.4"/><rect style="stroke:#000;stroke-width:2" width="207" height="23.6" x="196.25" y="137.6" fill="#EEE" filter="url(#f14n62ugonf14k)"/><text x="202.25" y="153.677" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193">Initialization (ECDH/secp256k1)</text><line style="stroke:#a80036;stroke-width:1" x1="29" x2="71" y1="192.8" y2="192.8"/><line style="stroke:#a80036;stroke-width:1" x1="71" x2="71" y1="192.8" y2="205.8"/><line style="stroke:#a80036;stroke-width:1" x1="30" x2="71" y1="205.8" y2="205.8"/><polygon fill="#A80036" points="40 201.8 30 205.8 40 209.8 36 205.8" style="stroke:#a80036;stroke-width:1"/><text x="36" y="187.277" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128">Calc Pub ECDH Key (</text><text x="164" y="187.277" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16">cP</text><text x="180" y="187.277" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4">)</text><polygon fill="#A80036" points="204 231.4 214 235.4 204 239.4 208 235.4" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="29" x2="210" y1="235.4" y2="235.4"/><text x="36" y="229.877" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95">init_api_secure (</text><text x="131" y="229.877" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16">cP</text><text x="147" y="229.877" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4">)</text><line style="stroke:#a80036;stroke-width:1" x1="216" x2="258" y1="265" y2="265"/><line style="stroke:#a80036;stroke-width:1" x1="258" x2="258" y1="265" y2="278"/><line style="stroke:#a80036;stroke-width:1" x1="217" x2="258" y1="278" y2="278"/><polygon fill="#A80036" points="227 274 217 278 227 282 223 278" style="stroke:#a80036;stroke-width:1"/><text x="223" y="259.477" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128">Calc Pub ECDH Key (</text><text x="351" y="259.477" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16">sP</text><text x="367" y="259.477" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4">)</text><line style="stroke:#a80036;stroke-width:1" x1="216" x2="258" y1="307.6" y2="307.6"/><line style="stroke:#a80036;stroke-width:1" x1="258" x2="258" y1="307.6" y2="320.6"/><line style="stroke:#a80036;stroke-width:1" x1="217" x2="258" y1="320.6" y2="320.6"/><polygon fill="#A80036" points="227 316.6 217 320.6 227 324.6 223 320.6" style="stroke:#a80036;stroke-width:1"/><text x="223" y="302.077" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162">Calc + store shared secret (</text><text x="385" y="302.077" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7">s</text><text x="392" y="302.077" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4">)</text><polygon fill="#A80036" points="40 346.2 30 350.2 40 354.2 36 350.2" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="34" x2="215" y1="350.2" y2="350.2"/><text x="46" y="344.677" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16">sP</text><line style="stroke:#a80036;stroke-width:1" x1="29" x2="71" y1="379.8" y2="379.8"/><line style="stroke:#a80036;stroke-width:1" x1="71" x2="71" y1="379.8" y2="392.8"/><line style="stroke:#a80036;stroke-width:1" x1="30" x2="71" y1="392.8" y2="392.8"/><polygon fill="#A80036" points="40 388.8 30 392.8 40 396.8 36 392.8" style="stroke:#a80036;stroke-width:1"/><text x="36" y="374.277" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162">Calc + store shared secret (</text><text x="198" y="374.277" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7">s</text><text x="205" y="374.277" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4">)</text></g></svg>